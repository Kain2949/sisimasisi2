/* ================================
   SUPER DARK THEME
   ================================ */
:root{
  --bg:           #01040a;   /* почти-чёрный с синевой */
  --surface:      #060912;   /* базовые карточки/панели */
  --surface-2:    #08111d;   /* кнопки/HUD */
  --surface-3:    #0b1830;   /* hover/акцентная поверхность */
  --ink:          #e8eefc;   /* основной текст (чуть мягче белого) */
  --muted:        #90a0bb;   /* вторичный */
  --accent:       #1f6cff;
  --accent-2:     #6ee7ff;

  --radius:       18px;
  --shadow:       0 14px 40px rgba(0,0,0,.65);
  --border:       1px solid rgba(255,255,255,.05);
}

*{ box-sizing: border-box; }
html, body{ height: 100%; }
body{
  margin: 0;
  background: var(--bg);
  color: var(--ink);
  font: 16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Arial;
}
.hidden{ display: none !important; }

/* во время прелоада прячем сцену */
body.booting .stage{ opacity: 0; pointer-events: none; }

/* ================================
   LAYOUT
   ================================ */
#app{ max-width: 1200px; margin: 24px auto; padding: 0 16px; }

.stage{
  display: grid;
  grid-template-columns: 1fr 420px;
  gap: 24px;
  transition: transform .28s ease, filter .28s ease, opacity .28s ease;
}

/* эффект "смотрю вниз" */
body.looking-down #stage{
  transform: translateY(-15vh);
  filter: blur(5px) brightness(.8);
}

/* ================================
   CARD / PANE
   ================================ */
.pane .card{
  position: relative;
  background: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
}

#desc{ min-height: 520px; display: flex; flex-direction: column; }

/* ФОН — через <img>, намеренно затемняем */
#bgImg{
  position: absolute; inset: 0;
  width: 100%; height: 100%;
  object-fit: cover;
  object-position: center;
  pointer-events: none;
  filter: brightness(.65) contrast(1.06) saturate(.95);
}

/* ТЕКСТ СЦЕНЫ */
#desc .text{
  position: relative;
  padding: 24px 26px 28px;
  font-size: 18px;
  min-height: 160px;
}

/* ================================
   ПРАВАЯ КОЛОНКА: ОПЦИИ
   ================================ */
.stack{ display: flex; flex-direction: column; gap: 12px; padding: 16px; }

.option{
  display: block;
  padding: 18px 20px;
  border-radius: var(--radius);
  background: var(--surface-2);
  border: var(--border);
  box-shadow: var(--shadow);
  color: #fff;
  text-align: left;
  cursor: pointer;
  transition: .2s transform, .2s background, .2s opacity, .2s border-color;
}
.option:hover{ transform: translateY(-2px); background: var(--surface-3); }

/* ================================
   НИЖНИЙ HUD
   ================================ */
.hudbar{
  position: absolute; left: 16px; right: 16px; bottom: 16px;
  display: flex; align-items: center;
  padding: 10px 12px; gap: 12px;
  background: rgba(2,6,12,.72);
  border: var(--border);
  border-radius: 14px;
  backdrop-filter: blur(6px);
}

.timer{
  margin-right: auto;
  padding: 6px 10px;
  border-radius: 999px;
  background: rgba(12,18,32,.7);
  border: 1px solid rgba(255,255,255,.06);
  font-size: 13px;
  color: #d0d8ea;
}

/* уменьшенная кнопка меню */
.hud-menu{
  width: 36px; height: 36px;
  border-radius: 50%;
  border: var(--border);
  background: var(--surface-2);
  color: var(--ink);
  cursor: pointer;
  font-size: 16px;
  line-height: 1;
  display: grid; place-items: center;
  box-shadow: var(--shadow);
  transition: .2s transform, .2s background, .2s opacity;
}
.hud-menu:hover{ transform: translateY(-1px); background: var(--surface-3); }

/* ================================
   BOOT
   ================================ */
.boot{
  position: fixed; inset: 0;
  background: var(--bg);
  display: grid; place-items: center;
  z-index: 10000;
}
.boot-box{
  width: min(520px, 92vw);
  background: var(--surface);
  border: var(--border);
  border-radius: 16px;
  padding: 22px;
  box-shadow: var(--shadow);
}
.boot-title{ font-weight: 700; margin-bottom: 12px; }
.boot-progress{ height: 10px; background: #0a0f18; border-radius: 999px; overflow: hidden; margin: 10px 0; }
.boot-progress > #bootBar{ height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent), var(--accent-2)); transition: width .15s ease; }
.boot-meta{ display: flex; gap: 8px; font-size: 13px; color: var(--muted); }
body.ready .boot{ display: none; }

/* ================================
   FULLSCREEN OVERLAYS
   ================================ */
.overlay{
  position: fixed; inset: 0;
  display: grid; place-items: center;
  background: var(--bg);               /* сплошной — за меню ничего не видно */
  z-index: 10001;
}

/* по умолчанию небольшие панели (инвентарь/флаги и т.п.) */
.panel{
  width: min(600px, 92vw);
  background: var(--surface);
  border: var(--border);
  border-radius: 16px;
  padding: 22px 22px 28px;
  box-shadow: var(--shadow);
}

/* главное меню / регистрация / лидерборд / настройки — во ВЕСЬ ЭКРАН и по центру */
#menuPanel, #regPanel, #lbPanel, #settingsPanel{
  width: min(640px, 96vw);
  height: 100vh;
  border-radius: 0;
  display: flex;
  flex-direction: column;
  justify-content: center;   /* по вертикали центр */
  align-items: center;       /* по горизонтали центр */
  gap: 16px;
}

/* бренд Raf Game дугой */
.brand{ margin: 0 0 10px 0; text-align: center; }
.brand-svg{ width: min(560px, 90vw); height: auto; filter: drop-shadow(0 8px 22px rgba(0,0,0,.45)); }
.brand-text{
  font: 800 56px/1 "Segoe UI", system-ui, Roboto, Arial;
  letter-spacing: 2px;
  paint-order: stroke fill;
  stroke: rgba(0,0,0,.35);
  stroke-width: 6px; /* псевдо-3D */
}

.menu-col{ display: grid; gap: 16px; width: min(520px, 92vw); }

/* все кнопки темнее, но контраст сохраняем */
.cta{
  width: 100%; appearance: none; border: var(--border);
  padding: 20px 24px; border-radius: 999px;
  background: var(--surface-2); color: var(--ink);
  font-size: 22px; font-weight: 800;
  cursor: pointer; transition: .2s transform, .2s background;
  text-align: center;
}
.cta:hover{ transform: translateY(-1px); background: var(--surface-3); }
.cta.ghost{ font-weight: 600; opacity: .95; }

/* нижний ряд — справа снизу и прижат к низу полноэкранной панели */
.menu-bottom{
  margin-top: auto;
  display: flex; justify-content: flex-end; gap: 16px;
  padding-bottom: 12px;
  width: min(520px, 92vw);
}
.round{
  width: 56px; height: 56px; border-radius: 50%;
  border: var(--border); background: var(--surface-2);
  color: var(--ink); box-shadow: var(--shadow);
  cursor: pointer; transition: .2s transform, .2s background;
}
.round:hover{ transform: translateY(-1px); background: var(--surface-3); }

/* Регистрация */
.form{ display: grid; gap: 12px; width: min(520px, 92vw); }
label{ display: grid; gap: 6px; font-size: 14px; color: #c8d1e3; }
input, select{
  appearance: none; background: #0a0f18;
  color: var(--ink); border: var(--border);
  border-radius: 10px; padding: 12px 12px; outline: none;
}
.dual{ display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
.btn{
  appearance: none; border: var(--border); background: var(--surface-2);
  color: var(--ink); border-radius: 12px; padding: 12px 14px;
  cursor: pointer; transition: .2s transform, .2s background, .2s opacity;
}
.btn:hover{ transform: translateY(-1px); background: var(--surface-3); }
.btn.quiet{ opacity: .9; }
.btn.warn{
  background: #231f14;
  border-color: rgba(255, 210, 90, .42);
  box-shadow: inset 0 0 0 1px rgba(255,210,90,.12), 0 0 24px rgba(255,220,120,.12);
}
.btn.warn:hover{ background: #2a2418; }

.muted{ color: var(--muted); font-size: 13px; }

/* Гендер — две кнопки */
.gender-toggle{ display: grid; gap: 8px; }
.gender-toggle .pills{ display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
.pill{
  appearance: none; border: var(--border); background: var(--surface-2);
  color: var(--ink); border-radius: 999px; padding: 12px 14px; cursor: pointer;
  transition: .2s transform, .2s background, .2s border-color, .2s color;
  text-align: center; font-weight: 700;
}
.pill:hover{ transform: translateY(-1px); background: var(--surface-3); }
.pill.active{ background: linear-gradient(180deg, #1e2436, #0f1628); border-color: rgba(120,180,255,.35); }

/* Лидерборд */
.lb-list{ display: grid; gap: 10px; margin-top: 8px; width: min(520px, 92vw); }
.lb-list .row{
  display: grid; grid-template-columns: 44px 1fr 1fr 90px;
  gap: 8px; align-items: center; padding: 10px 12px;
  background: var(--surface-2); border: var(--border); border-radius: 12px;
}
.lb-list .pos{ text-align: center; font-weight: 700; color: #b9c6ff; }
.lb-list .tag{ opacity: .95; }
.lb-list .time{ text-align: right; color: #dfe6ff; }

/* Диалоги */
dialog{ border: 0; border-radius: 14px; background: var(--surface); color: var(--ink); padding: 0; box-shadow: var(--shadow); }
dialog::backdrop{ background: rgba(0,0,0,.55); backdrop-filter: blur(2px); }
dialog .dlg-body{ padding: 20px 22px 12px; min-width: 300px; max-width: 92vw; max-height: 72vh; overflow: auto; }
dialog .close{ position: absolute; right: 6px; top: 6px; border: 0; background: transparent; color: var(--muted); font-size: 18px; cursor: pointer; }
.list{ display: grid; gap: 8px; margin-top: 8px; font-size: 14px; color: #d7dbe6; }

/* Веки */
.eyelid{ position: fixed; left: 0; right: 0; height: 0; background: #000; z-index: 9999; transition: height .18s ease; pointer-events: none; }
.eyelid.top{ top: 0; } .eyelid.bot{ bottom: 0; }

/* Внутриигровое меню */
.vstack{ display: grid; gap: 10px; }
.gm-panel{ position: relative; }
.close-gm{
  position: absolute; right: 8px; top: 8px;
  border: 0; background: transparent; color: var(--muted);
  font-size: 18px; cursor: pointer;
}

/* Визуальные помехи */
.fx{
  position: fixed; inset: 0; pointer-events: none; z-index: 10002;
  background: transparent; opacity: 1;
}
.fx.hidden{ display: none; }

@keyframes fx-noise { from{opacity:.0} 50%{opacity:.9} to{opacity:0} }
@keyframes fx-glitchX { 0%,100%{clip-path: inset(0 0 0 0)} 20%{clip-path: inset(30% 0 40% 0)} 40%{clip-path: inset(60% 0 10% 0)} 60%{clip-path: inset(10% 0 70% 0)} }
@keyframes fx-rgb { 0%{filter:none} 50%{filter: contrast(1.2) saturate(1.2) drop-shadow(0 0 0 #f00)} 100%{filter:none} }
@keyframes fx-scan { from{background: linear-gradient(180deg, rgba(255,255,255,.0) 0%, rgba(255,255,255,.2) 3%, rgba(0,0,0,0) 6%), transparent; background-size: 100% 6%; background-position-y:-6%} to{background-position-y:106%} }
@keyframes fx-roll { from{transform: translateY(-100%)} to{transform: translateY(0)} }
@keyframes fx-pixel { 0%{image-rendering: pixelated; filter: blur(0)} 40%{filter: blur(2px)} 100%{image-rendering: auto; filter: none} }
@keyframes fx-flash { 0%{background:#fff; opacity:1} 100%{background:transparent; opacity:0} }

.fx.noise{
  background-image: repeating-linear-gradient(0deg, rgba(255,255,255,.04) 0 2px, rgba(0,0,0,.0) 2px 4px);
  animation: fx-noise var(--dur,700ms) ease-in-out forwards;
}
.fx.glitch{ background: rgba(255,255,255,.02); animation: fx-glitchX var(--dur,800ms) steps(8) forwards; }
.fx.rgb{ background: rgba(0,0,0,.0); animation: fx-rgb var(--dur,800ms) ease-in-out forwards; mix-blend-mode: screen; }
.fx.scan{ animation: fx-scan var(--dur,900ms) linear forwards; }
.fx.roll{ background: rgba(255,255,255,.03); animation: fx-roll var(--dur,600ms) cubic-bezier(.3,.8,.3,1) forwards; }
.fx.pixel{ animation: fx-pixel var(--dur,800ms) ease-out forwards; backdrop-filter: contrast(1.1) saturate(1.1); }
.fx.flash{ animation: fx-flash var(--dur,500ms) ease-out forwards; }

/* Утилити */
.row{ display: flex; align-items: center; }
.between{ justify-content: space-between; }

/* Респонсив */
@media (max-width: 980px){
  .stage{ grid-template-columns: 1fr; }
  .dual{ grid-template-columns: 1fr; }
}
