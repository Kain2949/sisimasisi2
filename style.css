/* ================================
   Base
   ================================ */
:root{
  --bg: #070b12;
  --ink: #eaf0ff;
  --muted:#9fb0c7;

  --radius: 18px;
  --shadow: 0 18px 40px rgba(0,0,0,.55);
  --border-soft: 1px solid rgba(255,255,255,.16);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background: radial-gradient(1200px 700px at 50% -10%, #0e1522, #070b12);
  color:var(--ink);
  font:16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Arial;
}
.hidden{display:none !important}
button{font:inherit}

/* ================================
   Layout
   ================================ */
#app{max-width:1200px;margin:24px auto;padding:0 16px}
.stage{display:grid;grid-template-columns:1fr 420px;gap:24px;transition:transform .28s ease,filter .28s ease,opacity .28s ease}
body.looking-down #stage{transform:translateY(-15vh);filter:blur(5px) brightness(.9)}

/* ================================
   Glass material (updated)
   ================================ */
.glass{position:relative;background:transparent;border-radius:var(--radius);box-shadow:var(--shadow);isolation:isolate;overflow:visible}
.glass::before{
  content:"";position:absolute;inset:0;border-radius:inherit;pointer-events:none;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,.14),
    inset 0 8px 22px rgba(255,255,255,.22),
    inset 0 -10px 24px rgba(0,0,0,.38);
}
.glass::after{
  content:"";position:absolute;inset:0;border-radius:inherit;pointer-events:none;
  background: linear-gradient(to bottom, rgba(255,255,255,.28), rgba(255,255,255,0) 32%);
  mask: radial-gradient(120% 60% at 50% -20%, #000 45%, transparent 55%);
  mix-blend-mode: screen; opacity:.55;
}

/* Линзовый слой — отдельный элемент, чтобы текст не искажался */
.glass__lens{
  position:absolute;inset:0;border-radius:inherit;pointer-events:none;z-index:1;
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.03));
  backdrop-filter: blur(8px) saturate(120%); -webkit-backdrop-filter: blur(8px) saturate(120%);
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 10px 30px rgba(2,6,18,0.45), inset 0 1px 0 rgba(255,255,255,0.04);
  mix-blend-mode: normal;
  filter: url(#glass-distortion);
  transition: transform .18s cubic-bezier(.2,.9,.3,1), opacity .18s ease;
  will-change: transform, filter, opacity;
}
.glass__lens::before{
  content:""; position:absolute; inset:0; border-radius:inherit;
  background: radial-gradient(400px 140px at 18% 8%, rgba(255,255,255,0.85), rgba(255,255,255,0) 12%);
  mix-blend-mode: screen; opacity:0.6; filter: blur(6px); pointer-events:none;
}
.glass--panel{border-radius:22px}
.glass--btn{border-radius:999px}
.glass--hud{border-radius:16px}
.glass--input{border-radius:12px}

/* ensure background image sits under lens and content stays crisp */
#bgImg{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;object-position:center;filter:brightness(.62) contrast(1.06) saturate(.95);pointer-events:none;z-index:0}
.card .text, .card .stack, .card > *:not(.glass__lens){position:relative;z-index:2}

/* hover behavior */
.glass:hover .glass__lens, .glass:focus-within .glass__lens { transform: translateY(-4px) scale(1.02); opacity:0.98; }

/* ================================
   Cards & Scene
   ================================ */
.pane .card{position:relative;overflow:hidden}
#desc{min-height:520px;display:flex;flex-direction:column}
#desc .text{position:relative;padding:24px 26px 28px;font-size:18px;min-height:160px;text-shadow:0 1px 2px rgba(0,0,0,.8)}

.stack{display:flex;flex-direction:column;gap:12px;padding:16px}
.option{appearance:none;border:0;cursor:pointer;padding:18px 20px;text-align:left;color:var(--ink);border-radius:14px;background:transparent}
.option:hover{transform:translateY(-1px)}

/* ================================
   HUD
   ================================ */
.hudbar{position:absolute;left:16px;right:16px;bottom:16px;display:flex;align-items:center;gap:12px;padding:10px 12px;border:var(--border-soft)}
.timer{margin-right:auto;padding:6px 10px;border-radius:999px;border:var(--border-soft);background:rgba(10,16,28,.35);color:#d5e1ff;font-size:13px}
.hud-menu{width:36px;height:36px;display:grid;place-items:center;border:0;cursor:pointer}

/* ================================
   Boot
   ================================ */
.boot{position:fixed;inset:0;display:grid;place-items:center;background:var(--bg);z-index:10000}
.boot-box{padding:22px}
.boot-title{font-weight:700;margin-bottom:12px}
.boot-progress{height:10px;background:#0a101b;border-radius:999px;overflow:hidden;margin:10px 0}
.boot-progress>#bootBar{height:100%;width:0%;background:linear-gradient(90deg,#dfe9ff,#8fb7ff);transition:width .15s ease}
.boot-meta{display:flex;gap:8px;font-size:13px;color:var(--muted)}
body.ready .boot{display:none}

/* ================================
   Lamp sign styles (DOM bulbs)
   ================================ */
.lamp-sign{position:relative; display:block; width:100%; height:140px; overflow:visible}
.lamp-sign .bulb{position:absolute;width:13px;height:13px;transform:translate(-50%,-50%);border-radius:50%;
  background: radial-gradient(circle at 45% 40%, #ffdba0 0%, #7a4a1a 65%, #321c0b 100%);
  box-shadow:0 0 0 1px rgba(255,255,255,.06) inset, 0 2px 6px rgba(0,0,0,.6); filter:saturate(1.05);}
.lamp-sign .bulb .b-core{position:absolute;inset:0;border-radius:50%;background:radial-gradient(circle at 50% 50%, rgba(255,210,120,.95) 0%, rgba(255,180,70,.65) 30%, rgba(255,160,40,0) 65%);opacity:0;transition:opacity .14s ease;mix-blend-mode: screen;}
.lamp-sign .bulb .b-glow{position:absolute;left:50%;top:50%;width:0;height:0;pointer-events:none;box-shadow:0 0 18px 6px rgba(255,200,90,.85),0 0 34px 12px rgba(255,200,90,.35);opacity:0;transition:opacity .14s ease;}
.lamp-sign .bulb .b-glass{position:absolute;inset:0;border-radius:50%;pointer-events:none;background:radial-gradient(60% 60% at 30% 30%, rgba(255,255,255,.45), rgba(255,255,255,0) 60%),radial-gradient(80% 80% at 70% 70%, rgba(255,255,255,.12), rgba(255,255,255,0) 70%);mix-blend-mode: screen;opacity:.55;}
.lamp-sign .bulb.on .b-core{opacity:1}
.lamp-sign .bulb.on .b-glow{opacity:1}
.lamp-sign .bulb.off{filter:grayscale(.6) brightness(.65)}
.lamp-sign .bulb.dead{filter:grayscale(1) brightness(.35);box-shadow:0 1px 4px rgba(0,0,0,.7) inset}
.lamp-sign .bulb.on{animation:microFlick 2.6s ease-in-out infinite; animation-delay: calc(var(--i, 0) * 27ms);}

@keyframes microFlick{0%,100%{opacity:1;filter:brightness(1)}50%{opacity:.96;filter:brightness(.98)}}

/* ================================
   Overlays & Panels
   ================================ */
.overlay{position:fixed;inset:0;display:grid;place-items:center;background:rgba(6,8,12,.72);z-index:10001}
.panel{width:min(700px,96vw);padding:26px 24px 28px;border:var(--border-soft)}
.panel.main{height:100vh;border-radius:0;display:flex;flex-direction:column;justify-content:center;gap:16px}
.menu-col{display:grid;gap:16px}
.cta{width:100%;padding:20px 24px;font-size:22px;font-weight:800;color:var(--ink);cursor:pointer;border:0;background:transparent}
.cta.ghost{font-weight:600;opacity:.95}
.menu-bottom{margin-top:auto;display:flex;justify-content:flex-end;gap:16px;padding-bottom:10px}
.round{width:56px;height:56px;display:grid;place-items:center;border:0;cursor:pointer}

/* ================================
   Responsive
   ================================ */
@media (max-width:980px){
  .stage{grid-template-columns:1fr}
  .dual{grid-template-columns:1fr}
  .panel.main{height:auto;padding-top:32px;padding-bottom:32px}
}

/* mobile fallback for browsers without backdrop-filter */
@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  .glass__lens { backdrop-filter: none; background: rgba(255,255,255,0.06); filter: none; }
}
